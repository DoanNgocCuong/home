```
… /deploy] └4 <base> main(+15/-0,+10/-11)* ± sudo docker compose down [+] Running 2/2 ✔ Container 30005-dev-job-search-rag-api Removed 0.8s ! Network deploy_default Resource is still in use 0.0s θ75° 2d [ubuntu@mgc-dev2-3090:~/cuong_dn/MiniProd_Web4_ContentEngFlow_StepUpE_T102024/θ75° 2d [ubuntu@mgc-dev2-3090:~/cuong_dn/MiniProd_Web4_ContentEngFlow_StepUpE_T102024/ … /de ploy]└4 <base> main(+15/-0,+10/-11)* ± network mặc định là sao
```

Khi bạn chạy lệnh:

`sudo docker compose down`

và thấy thông báo:

`✔ Container <...> Removed ! Network deploy_default Resource is still in use`

thì điều này có nghĩa là:

---

### ✅ **Giải thích "network mặc định":**

Trong Docker Compose, nếu bạn **không khai báo rõ ràng một mạng (`networks`)** trong file `docker-compose.yml`, thì Docker sẽ **tự động tạo một mạng "mặc định" (default network)** cho các container trong project đó.

Tên mặc định của network này thường có dạng:

`<folder-name>_default`

Ví dụ:  
Nếu thư mục chứa `docker-compose.yml` của bạn là `deploy`, thì Docker Compose sẽ tự tạo network tên là `deploy_default`.

---

### ⚠️ **Tại sao network vẫn “in use”?**

Lý do dòng:

`! Network deploy_default Resource is still in use`

xuất hiện là vì **Docker thấy vẫn còn container nào đó đang dùng network này**. Một số nguyên nhân:

- Bạn đang dùng network đó trong một container khác **không bị xóa** do không nằm trong file `docker-compose.yml` hiện tại.
    
- Một container được tạo trước đó thủ công (`docker run`) có gán network đó.
    
- Docker gặp lỗi khi cleanup, đôi khi chỉ cần đợi vài giây hoặc thử lại.


Trong trường hợp của bạn, network `prod_deploy_default` **không phải do mọi người tự đặt tên** mà do **Docker Compose tự động sinh ra**.

Cơ chế là:

- Khi bạn chạy `docker compose up` trong một thư mục có file `docker-compose.yml`, Docker Compose sẽ tạo một **project name** (theo mặc định là tên thư mục, ở đây là `prod_deploy`).
    
- Sau đó nó sinh ra network mặc định cho các service, tên là:
    
    ```
    <project_name>_default
    ```
    
    → tức là `prod_deploy_default`.
    

👉 Vì vậy:

- Nếu bạn **không định nghĩa network** trong `docker-compose.yml`, Docker sẽ tự tạo một network default như trên.
    
- Nếu muốn có tên khác hoặc subnet rõ ràng, bạn có thể tự định nghĩa trong `docker-compose.yml`, ví dụ:
    
    ```yaml
    networks:
      my_custom_network:
        driver: bridge
        ipam:
          config:
            - subnet: 10.123.0.0/16
    ```
    

Sau đó gán service vào:

```yaml
services:
  api:
    build: .
    networks:
      - my_custom_network
```

---

Bạn có muốn mình viết cho bạn một đoạn cấu hình `docker-compose.yml` mẫu với network có **subnet riêng** (để tránh lỗi overlap như trên) không?