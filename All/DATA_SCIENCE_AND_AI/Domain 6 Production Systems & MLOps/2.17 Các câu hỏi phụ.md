```
docker rm -f $(docker ps -aq)  # xoá hết container
```


# 1. Nên để docker compose ở ngoài hay để nó trong thư mục deploy cái nào là best practices ?


Tùy thuộc vào quy mô và complexity của project. Đây là breakdown theo best practices:

## 1. Small/Medium Projects - Root Level (Phổ biến nhất)

```bash
project/
├── docker-compose.yml          # Main compose
├── docker-compose.override.yml # Local development  
├── .env
├── .env.example
├── Dockerfile
├── src/
├── package.json
└── README.md
```

**Ưu điểm:**

- Đơn giản, dễ tìm
- Quen thuộc với devs
- Docker Compose auto-discover

**Nhược điểm:**

- Root cluttered khi có nhiều files

## 2. Complex Projects - Deploy Folder (Khuyên dùng)

```bash
project/
├── deploy/
│   ├── docker-compose.yml
│   ├── docker-compose.prod.yml
│   ├── docker-compose.dev.yml  
│   ├── .env
│   ├── .env.example
│   ├── .env.prod
│   ├── nginx/
│   │   └── nginx.conf
│   └── scripts/
│       ├── deploy.sh
│       └── backup.sh
├── src/
├── tests/
├── docs/
├── Dockerfile
└── README.md
```

**Commands:**

```bash
# Development
cd deploy/
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

# Production  
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up
```

## 3. Multi-Environment - Environments Folder

```bash
project/
├── deployments/
│   ├── development/
│   │   ├── docker-compose.yml
│   │   └── .env
│   ├── staging/
│   │   ├── docker-compose.yml  
│   │   └── .env
│   ├── production/
│   │   ├── docker-compose.yml
│   │   └── .env
│   └── shared/
│       ├── nginx.conf
│       └── scripts/
├── src/
└── Dockerfile
```

## 4. Enterprise/Microservices - Organized Structure

```bash
project/
├── infrastructure/          # Infrastructure services
│   ├── docker-compose.yml  # Redis, PostgreSQL, etc.
│   └── .env
├── services/
│   ├── api/
│   │   ├── Dockerfile
│   │   └── src/
│   └── worker/
│       ├── Dockerfile  
│       └── src/
├── deploy/
│   ├── docker-compose.yml      # Application services
│   ├── docker-compose.infra.yml
│   ├── k8s/                    # Kubernetes manifests
│   └── helm/                   # Helm charts
└── scripts/
    ├── dev-start.sh
    └── prod-deploy.sh
```

## 5. Monorepo Approach

```bash
company-projects/
├── infrastructure/
│   └── docker-compose.yml     # Shared infra
├── project-a/
│   ├── deploy/
│   │   └── docker-compose.yml
│   └── src/
├── project-b/  
│   ├── deploy/
│   │   └── docker-compose.yml
│   └── src/
└── scripts/
    └── start-all.sh
```

## Recommendations theo use case:

### Small Project (1-3 services)

```bash
# Root level - KISS principle
project/
├── docker-compose.yml
├── .env
└── src/
```

### Medium Project (4-10 services)

```bash
# Deploy folder - Organization
project/
├── deploy/
│   ├── docker-compose.yml
│   ├── docker-compose.override.yml
│   └── .env
├── src/
└── Dockerfile
```

### Large/Enterprise Project

```bash
# Separated by environment + infra
project/
├── infrastructure/
├── deploy/
│   ├── environments/
│   ├── k8s/
│   └── helm/
└── services/
```

## Script helpers:

**`scripts/dev.sh`:**

```bash
#!/bin/bash
cd deploy/
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d
```

**`scripts/prod-deploy.sh`:**

```bash
#!/bin/bash
cd deploy/
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

## Makefile approach:

```makefile
# Makefile ở root
.PHONY: dev prod infra

dev:
	cd deploy && docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

prod:  
	cd deploy && docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

infra:
	cd infrastructure && docker-compose up -d

clean:
	docker-compose -f deploy/docker-compose.yml down
	docker system prune -f
```

## Kết luận:

**Theo project của bạn (có worker, redis, complex setup):**

👍 **Khuyên dùng: Deploy folder**

```bash
robot-ai-workflow/
├── deploy/
│   ├── docker-compose.yml
│   ├── docker-compose.dev.yml  
│   ├── .env
│   └── .env.example
├── src/
├── workers/
├── Dockerfile
└── README.md
```

**Lý do:**

- Tách biệt deployment config khỏi source code
- Dễ manage multiple environments
- Scale tốt khi project lớn lên
- Team lead/DevOps dễ maintain