```
docker rm -f $(docker ps -aq)  # xoÃ¡ háº¿t container
```


# 1. NÃªn Ä‘á»ƒ docker compose á»Ÿ ngoÃ i hay Ä‘á»ƒ nÃ³ trong thÆ° má»¥c deploy cÃ¡i nÃ o lÃ  best practices ?


TÃ¹y thuá»™c vÃ o quy mÃ´ vÃ  complexity cá»§a project. ÄÃ¢y lÃ  breakdown theo best practices:

## 1. Small/Medium Projects - Root Level (Phá»• biáº¿n nháº¥t)

```bash
project/
â”œâ”€â”€ docker-compose.yml          # Main compose
â”œâ”€â”€ docker-compose.override.yml # Local development  
â”œâ”€â”€ .env
â”œâ”€â”€ .env.example
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ src/
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

**Æ¯u Ä‘iá»ƒm:**

- ÄÆ¡n giáº£n, dá»… tÃ¬m
- Quen thuá»™c vá»›i devs
- Docker Compose auto-discover

**NhÆ°á»£c Ä‘iá»ƒm:**

- Root cluttered khi cÃ³ nhiá»u files

## 2. Complex Projects - Deploy Folder (KhuyÃªn dÃ¹ng)

```bash
project/
â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ docker-compose.prod.yml
â”‚   â”œâ”€â”€ docker-compose.dev.yml  
â”‚   â”œâ”€â”€ .env
â”‚   â”œâ”€â”€ .env.example
â”‚   â”œâ”€â”€ .env.prod
â”‚   â”œâ”€â”€ nginx/
â”‚   â”‚   â””â”€â”€ nginx.conf
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ deploy.sh
â”‚       â””â”€â”€ backup.sh
â”œâ”€â”€ src/
â”œâ”€â”€ tests/
â”œâ”€â”€ docs/
â”œâ”€â”€ Dockerfile
â””â”€â”€ README.md
```

**Commands:**

```bash
# Development
cd deploy/
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

# Production  
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up
```

## 3. Multi-Environment - Environments Folder

```bash
project/
â”œâ”€â”€ deployments/
â”‚   â”œâ”€â”€ development/
â”‚   â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”‚   â””â”€â”€ .env
â”‚   â”œâ”€â”€ staging/
â”‚   â”‚   â”œâ”€â”€ docker-compose.yml  
â”‚   â”‚   â””â”€â”€ .env
â”‚   â”œâ”€â”€ production/
â”‚   â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”‚   â””â”€â”€ .env
â”‚   â””â”€â”€ shared/
â”‚       â”œâ”€â”€ nginx.conf
â”‚       â””â”€â”€ scripts/
â”œâ”€â”€ src/
â””â”€â”€ Dockerfile
```

## 4. Enterprise/Microservices - Organized Structure

```bash
project/
â”œâ”€â”€ infrastructure/          # Infrastructure services
â”‚   â”œâ”€â”€ docker-compose.yml  # Redis, PostgreSQL, etc.
â”‚   â””â”€â”€ .env
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â””â”€â”€ src/
â”‚   â””â”€â”€ worker/
â”‚       â”œâ”€â”€ Dockerfile  
â”‚       â””â”€â”€ src/
â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ docker-compose.yml      # Application services
â”‚   â”œâ”€â”€ docker-compose.infra.yml
â”‚   â”œâ”€â”€ k8s/                    # Kubernetes manifests
â”‚   â””â”€â”€ helm/                   # Helm charts
â””â”€â”€ scripts/
    â”œâ”€â”€ dev-start.sh
    â””â”€â”€ prod-deploy.sh
```

## 5. Monorepo Approach

```bash
company-projects/
â”œâ”€â”€ infrastructure/
â”‚   â””â”€â”€ docker-compose.yml     # Shared infra
â”œâ”€â”€ project-a/
â”‚   â”œâ”€â”€ deploy/
â”‚   â”‚   â””â”€â”€ docker-compose.yml
â”‚   â””â”€â”€ src/
â”œâ”€â”€ project-b/  
â”‚   â”œâ”€â”€ deploy/
â”‚   â”‚   â””â”€â”€ docker-compose.yml
â”‚   â””â”€â”€ src/
â””â”€â”€ scripts/
    â””â”€â”€ start-all.sh
```

## Recommendations theo use case:

### Small Project (1-3 services)

```bash
# Root level - KISS principle
project/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â””â”€â”€ src/
```

### Medium Project (4-10 services)

```bash
# Deploy folder - Organization
project/
â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ docker-compose.override.yml
â”‚   â””â”€â”€ .env
â”œâ”€â”€ src/
â””â”€â”€ Dockerfile
```

### Large/Enterprise Project

```bash
# Separated by environment + infra
project/
â”œâ”€â”€ infrastructure/
â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ k8s/
â”‚   â””â”€â”€ helm/
â””â”€â”€ services/
```

## Script helpers:

**`scripts/dev.sh`:**

```bash
#!/bin/bash
cd deploy/
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d
```

**`scripts/prod-deploy.sh`:**

```bash
#!/bin/bash
cd deploy/
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

## Makefile approach:

```makefile
# Makefile á»Ÿ root
.PHONY: dev prod infra

dev:
	cd deploy && docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

prod:  
	cd deploy && docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

infra:
	cd infrastructure && docker-compose up -d

clean:
	docker-compose -f deploy/docker-compose.yml down
	docker system prune -f
```

## Káº¿t luáº­n:

**Theo project cá»§a báº¡n (cÃ³ worker, redis, complex setup):**

ğŸ‘ **KhuyÃªn dÃ¹ng: Deploy folder**

```bash
robot-ai-workflow/
â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ docker-compose.dev.yml  
â”‚   â”œâ”€â”€ .env
â”‚   â””â”€â”€ .env.example
â”œâ”€â”€ src/
â”œâ”€â”€ workers/
â”œâ”€â”€ Dockerfile
â””â”€â”€ README.md
```

**LÃ½ do:**

- TÃ¡ch biá»‡t deployment config khá»i source code
- Dá»… manage multiple environments
- Scale tá»‘t khi project lá»›n lÃªn
- Team lead/DevOps dá»… maintain