```
Today  
  
**Minh Huy** 8:10 PM  
Share rá»“i Ã¡.  
  
**Son Le** 8:10 PM  
hinh nhu chua share man hinh sep oi  
  
**toan tran fr33w1f1** 8:10 PM  
cÃ³ mÃ   
  
**ğŸ‡»ğŸ‡³ Long Phan (minhlong2605)** 8:10 PM  
share rá»“i sÃ­p  
  
**Son Le** 8:11 PM  
la vay =))  
  
**ğŸ‡»ğŸ‡³ Long Phan (minhlong2605)** 8:11 PM  
tháº¥y rÃµ láº¯m sÃ­p  
load test? :v  
stress test? :v  
  
**Nguyá»…n Tiáº¿n SÆ¡n (sotsuba)** 8:13 PM  
request  
  
**Minh Huy** 8:13 PM  
Scalability testin  
  
**NghÄ©a Huá»³nh HoÃ ng Trung** 8:13 PM  
request per second ?  
  
**Minh Tuáº¥n** 8:18 PM  
deamonset ğŸ˜„  
  
**FSDS** 8:18 PM  
https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/  
  
**Duc Le (ducle6789)** 8:21 PM  
nhá» láº¯m sáº¿p  
  
**Trinh Mai (chelton.m)** 8:21 PM  
bth mÃ  sáº¿p  
  
**Vuong Toan (zztoanvt )** 8:21 PM  
size chu i sep  
  
**ğŸ‡»ğŸ‡³ Long Phan (minhlong2605)** 8:21 PM  
Ã½ lÃ  zoom lÃªn Ã¡ sÃ­p  
  
**Quá»‘c Khang (khangtran0306)** 8:20 PM  
to lÃªn tÃ­ Ä‘i sÃ­p  
  
**toan tran fr33w1f1** 8:21 PM  
to lÃ  to mÃ n hÃ¬nh Ã   
Messages addressed to "meeting group chat" will also appear in the meeting group chat in Team Chat  
Due to the large number of participants in this meeting, system messages for those who joined or left have been disabled  
  
**Minh Huy** 8:37 PM  
Biáº¿n Ä‘áº¿m, chá»‰ tÄƒng khÃ´ng gá»‰am, sá»‘ nguyÃªn áº¡?  
  
**Nguyá»…n Tiáº¿n SÆ¡n (sotsuba)** 8:37 PM  
counter lÃ  chá»‰ cÃ³ tÄƒng thÃ´i áº¡  
  
**ğŸ‡»ğŸ‡³ Long Phan (minhlong2605)** 8:37 PM  
Ä‘áº¿m áº¡?  
  
**Minh Huy** 8:41 PM  
Náº¿u prometheus lÃ  1 database vá» metrics thÃ¬ nÃ³ cÅ©ng cÃ³ kháº£ nÄƒng cháº¿t sáº¿p nhá»‰? (do thu tháº­p metrics nhiá»u quÃ¡). Thá»±c táº¿ thÃ¬ kháº£ nÄƒng chá»‹u táº£i cá»§a prometheus nhÆ° tháº¿ nÃ o sáº¿p nhá»‰?  
  
**You** 8:57 PM  
hÃ³ng áº¡  
  
**Minh Huy** 8:42 PM  
Dáº¡, náº¿u 1 api mÃ  mÃ¬nh vá»«a lÃ m nhiá»‡m vá»¥ chÃ­nh nÃ³ (vÃ­ dá»¥ lÃ m ocr) vÃ  log metrics (tÃ­nh metrics + log) thÃ¬ em nghÄ© api mÃ¬nh sáº½ bá»‹ tÄƒng latency. Náº¿u 1 api Ä‘ang bá»‹ rÃ ng buá»™c latency tháº¥p thÃ¬ sáº¿p cÃ³ cÃ¡ch nÃ o khÃ´ng áº¡?  
Vá»›i em tháº¯c máº¯c sao láº¡i phÃ¡t sinh database prometheus sáº¿p nhá»‰? Sao mn khÃ´ng dÃ¹ng database cÃ³ sáºµn (MongoDB?), rá»“i kÃ©o dá»¯ liá»‡u lÃªn UI áº¡?  
  
**Minh Tuáº¥n** 8:45 PM  
nhÆ°ng mÃ  grafana kÃ©o dá»¯ liá»‡u tá»« prometheus mÃ  sáº¿p :v  
lá»¡ grafana request liÃªn tá»¥c thÃ¬ sao  
  
**Vu** 8:47 PM  
Do lÆ°á»£ng user vÃ´ grafana ko nhiá»u nhÆ° consumer app request nÃªn ko bá»‹ háº£ sáº¿p?  
  
**FSDS** 8:51 PM  
https://docs.timescale.com/  
  
**ğŸ‡»ğŸ‡³ Long Phan (minhlong2605)** 8:54 PM  
Ã  e chÆ°a rÃµ vÃ­ dá»¥ request 3 láº§n sao ko Ä‘á»ƒ 3 mÃ  Ä‘á»ƒ 30 váº­y sÃ­p  
ok áº¡  
  
**NghÄ©a Huá»³nh HoÃ ng Trung** 8:56 PM  
sá»‘ request / thá»i gian chá»© sÃ­p nhá»‰
```


DÆ°á»›i Ä‘Ã¢y lÃ  báº£n **tÃ³m táº¯t chi tiáº¿t vÃ  cÃ³ há»‡ thá»‘ng** vá» buá»•i tháº£o luáº­n hÃ´m nay, bao gá»“m cáº£ **ká»¹ thuáº­t vÃ  trao Ä‘á»•i nhÃ³m**:

---

## ğŸ¯ **Chá»§ Ä‘á» chÃ­nh**: _GiÃ¡m sÃ¡t há»‡ thá»‘ng & Hiá»‡u nÄƒng API_

---

### ğŸ–¥ï¸ **1. Chia sáº» mÃ n hÃ¬nh â€“ Má»Ÿ Ä‘áº§u há»p**

- CÃ¡c thÃ nh viÃªn pháº£n Ã¡nh vá» kÃ­ch cá»¡ hoáº·c kháº£ nÄƒng nhÃ¬n rÃµ mÃ n hÃ¬nh:
    
    - Nhiá»u comment nhÆ° â€œto lÃªn tÃ­â€, â€œzoom lÃªnâ€, â€œnhá» láº¯m sáº¿pâ€.
        
    - ÄÆ°á»£c xÃ¡c nháº­n lÃ  Ä‘Ã£ share mÃ n hÃ¬nh (Minh Huy, Long Phan).
        
- KhÃ´ng khÃ­ vui váº», pha chÃºt hÃ i hÆ°á»›c vÃ  gá»£i má»Ÿ cho tháº£o luáº­n chuyÃªn sÃ¢u phÃ­a sau.
    

---

### ğŸš€ **2. Load Test, Stress Test & Scalability**

- CÃ¡c loáº¡i kiá»ƒm thá»­ hiá»‡u nÄƒng Ä‘Æ°á»£c nháº¯c tá»›i:
    
    - **Load test**, **Stress test**, **Scalability testing**
        
    - **Request per second (RPS)** â€“ thÆ°á»›c Ä‘o phá»• biáº¿n trong kiá»ƒm thá»­ táº£i.
        
- Gá»£i Ã½ cÃ´ng cá»¥ Kubernetes: **DaemonSet** Ä‘á»ƒ triá»ƒn khai workload Ä‘á»u lÃªn táº¥t cáº£ node (FSDS chia sáº» link tÃ i liá»‡u chÃ­nh thá»©c).
    

---

### ğŸ“Š **3. Prometheus â€“ Æ¯u Ä‘iá»ƒm vÃ  lo ngáº¡i**

#### â“ **CÃ¢u há»i Ä‘áº·t ra:**

- **Prometheus cÃ³ thá»ƒ â€œcháº¿tâ€ khÃ´ng náº¿u thu tháº­p quÃ¡ nhiá»u metric?**
    
    - Lo ngáº¡i hiá»‡u nÄƒng giáº£m náº¿u API vá»«a thá»±c thi task chÃ­nh vá»«a ghi log/metrics (OCR + logging).
        
- **Táº¡i sao khÃ´ng dÃ¹ng MongoDB hoáº·c cÃ¡c DB khÃ¡c?**
    

#### âœ… **Tráº£ lá»i & giáº£i thÃ­ch tá»« Son Le vÃ  Vu:**

- Prometheus Ã­t khi sáº­p vÃ¬ **metrics nháº¹**, khÃ´ng tá»‘n nhiá»u tÃ i nguyÃªn nhÆ° log.
    
- Náº¿u Prometheus thá»±c sá»± quÃ¡ táº£i:
    
    - Giáº£i phÃ¡p lÃ  **tÃ¡ch Prometheus theo há»‡ thá»‘ng**, vÃ­ dá»¥ â€œmá»—i há»‡ 1 conâ€.
        
- CÃ¡i thÆ°á»ng â€œsáº­pâ€ lÃ  cá»¥m **log collector** nhÆ° **Loki hoáº·c Elasticsearch** do log náº·ng hÆ¡n.
    
- **Grafana** chá»‰ kÃ©o dá»¯ liá»‡u tá»« Prometheus, vÃ  thÆ°á»ng lÆ°á»£ng user nhá», khÃ´ng gÃ¢y táº£i lá»›n.
    

#### ğŸ’¡ **ThÃªm gá»£i Ã½ tá»« FSDS:**

- CÃ³ thá»ƒ tham kháº£o thÃªm **TimescaleDB** â€“ giáº£i phÃ¡p lÆ°u trá»¯ time-series metrics máº¡nh máº½ hÆ¡n náº¿u cáº§n custom hoáº·c scale phá»©c táº¡p hÆ¡n.
    

---

### ğŸ“ˆ **4. Vá» Counter vÃ  sá»‘ liá»‡u metrics**

- **Counter**: loáº¡i biáº¿n trong Prometheus chá»‰ cÃ³ tÄƒng chá»© khÃ´ng giáº£m.
    
- CÃ¢u há»i: Táº¡i sao gá»i 3 láº§n láº¡i hiá»‡n 30 request?
    
    - Giáº£i thÃ­ch kháº£ thi:
        
        - CÃ³ thá»ƒ tÃ­nh theo **request/giÃ¢y**, hoáº·c tá»•ng há»£p tá»« **nhiá»u thread/instance**.
            
        - Hoáº·c do **bá»‹ nhÃ¢n lÃªn tá»« layer trung gian (ngháº½n, retry, proxy)**.
            

---

### ğŸ’½ **5. Prometheus cÃ³ lÆ°u xuá»‘ng Ä‘Ä©a khÃ´ng?**

- CÃ¢u há»i cá»§a NghÄ©a: Prometheus cÃ³ lÆ°u state xuá»‘ng Ä‘Ä©a?
    
    - â†’ _ChÆ°a cÃ³ cÃ¢u tráº£ lá»i trá»±c tiáº¿p_ trong log Ä‘oáº¡n chat nÃ y, nhÆ°ng Ä‘á»ƒ bá»• sung cho báº¡n:
        
        - **CÃ³**, Prometheus lÆ°u dá»¯ liá»‡u dÆ°á»›i dáº¡ng **time-series DB** trÃªn local disk (TSDB: Time Series Database).
            
        - LÆ°u theo block (2 giá»/block), vá»›i retention cÃ³ thá»ƒ cáº¥u hÃ¬nh.
            

---

## ğŸ“Œ Tá»•ng káº¿t

- Buá»•i há»p cung cáº¥p nhiá»u **kiáº¿n thá»©c thá»±c chiáº¿n**:
    
    - Tá»« cÃ¡ch giÃ¡m sÃ¡t hiá»‡u nÄƒng vá»›i Prometheus Ä‘áº¿n cáº¥u trÃºc lÆ°u metrics vÃ  lá»±a chá»n thiáº¿t káº¿.
        
- **Phong cÃ¡ch tháº£o luáº­n thoáº£i mÃ¡i**, thÃ¢n thiá»‡n nhÆ°ng ráº¥t ká»¹ thuáº­t â€“ Ä‘Ãºng cháº¥t cá»§a má»™t team DevOps hoáº·c Backend cÃ³ kinh nghiá»‡m.
    

---

Báº¡n muá»‘n mÃ¬nh giáº£i thÃ­ch ká»¹ hÆ¡n pháº§n nÃ o? VÃ­ dá»¥:

- So sÃ¡nh Prometheus vs TimescaleDB?
    
- Gá»£i Ã½ cÃ¡ch giáº£m latency khi API vá»«a lÃ m viá»‡c chÃ­nh vá»«a log?
    
- Thiáº¿t káº¿ Prometheus cluster Ä‘á»ƒ high availability?
    

MÃ¬nh sáºµn sÃ ng má»Ÿ rá»™ng!


---
SWAP memory: dÃ¹ng disk lÃ m mem, Ä‘á»ƒ trÃ¡nh trÆ°á»ng há»£p bá»‹ cháº¡m ngÆ°á»¡ng. Äá»«ng láº¡m dá»¥ng SWAP vÃ¬ nÃ³ bá»‹ cháº­m 

---
CÃ¢u há»i "Con nÃ o sáº½ lÆ°u trá»¯ cÃ¡c cÃ¢u request áº¡?" cÃ³ thá»ƒ hiá»ƒu theo ngá»¯ cáº£nh buá»•i há»p cá»§a báº¡n lÃ :

> **Trong há»‡ thá»‘ng monitoring/logging hiá»‡n táº¡i (Prometheus, Grafana, v.v.) thÃ¬ "thÃ nh pháº§n nÃ o" lÆ°u trá»¯ thÃ´ng tin chi tiáº¿t vá» cÃ¡c cÃ¢u request (API call/request)?**

DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch chi tiáº¿t theo tá»«ng cÃ´ng cá»¥:

---

## ğŸ§© **1. Prometheus â€“ ChuyÃªn lÆ°u metric (khÃ´ng lÆ°u raw request)**

- Prometheus **khÃ´ng lÆ°u tá»«ng cÃ¢u request cá»¥ thá»ƒ** (vÃ­ dá»¥: request body, headers).
    
- Thay vÃ o Ä‘Ã³, nÃ³ lÆ°u **metrics dáº¡ng tá»•ng há»£p**, nhÆ°:
    
    - `http_requests_total` â€“ sá»‘ lÆ°á»£ng request.
        
    - `http_request_duration_seconds` â€“ thá»i gian xá»­ lÃ½ request (histogram/summary).
        
    - CÃ¡c label nhÆ° `method`, `status_code`, `path`, `instance`, `job`.
        

ğŸ“Œ **Káº¿t luáº­n**: Prometheus _khÃ´ng pháº£i nÆ¡i lÆ°u raw request_, mÃ  chá»‰ lÆ°u dáº¡ng **Ä‘áº¿m vÃ  thá»‘ng kÃª**.

---

## ğŸ§© **2. Loki hoáº·c Elasticsearch â€“ LÆ°u log chi tiáº¿t (náº¿u cÃ³ cáº¥u hÃ¬nh)**

- Náº¿u muá»‘n lÆ°u **cÃ¢u request tháº­t sá»±**, báº¡n cáº§n dÃ¹ng **log aggregator** nhÆ°:
    
    - [Loki](https://grafana.com/oss/loki/) (Ä‘Æ°á»£c tÃ­ch há»£p tá»‘t vá»›i Grafana).
        
    - [Elasticsearch](https://www.elastic.co/elasticsearch/) (náº¿u dÃ¹ng ELK stack).
        
- CÃ¡c cÃ´ng cá»¥ nÃ y **thu tháº­p log tá»« app** (stdout, file log...) rá»“i lÆ°u trá»¯ **ná»™i dung request Ä‘áº§y Ä‘á»§** nhÆ°:
    
    - Timestamps
        
    - Request URL, query string, headers, body (náº¿u app log ra)
        
    - Status code, response time...
        

ğŸ“Œ **Káº¿t luáº­n**: **Loki hoáº·c Elasticsearch** sáº½ lÃ  nÆ¡i "lÆ°u cÃ¡c cÃ¢u request" náº¿u app cá»§a báº¡n log ra thÃ´ng tin Ä‘Ã³.

---

## ğŸ§© **3. á»¨ng dá»¥ng gá»‘c (API server) â€“ Log trá»±c tiáº¿p (trÆ°á»›c khi Ä‘áº©y Ä‘i)**

- Má»™t sá»‘ há»‡ thá»‘ng tá»± log ra file (`.log`), hoáº·c gá»­i qua Fluent Bit/Fluentd â†’ Ä‘áº©y sang Loki/Elastic.
    
- VÃ­ dá»¥:
    
    ```bash
    [INFO] GET /api/v1/ocr?id=123 - 200 OK - 34ms
    ```
    

ğŸ“Œ **Káº¿t luáº­n**: Dá»¯ liá»‡u gá»‘c vá» tá»«ng request thÆ°á»ng **báº¯t nguá»“n tá»« app**, cÃ¡c tool nhÆ° Loki chá»‰ lÃ  nÆ¡i lÆ°u trá»¯ & truy váº¥n sau Ä‘Ã³.

---

## âœ… Tá»•ng káº¿t

|CÃ´ng cá»¥|LÆ°u metrics|LÆ°u cÃ¢u request (chi tiáº¿t)|Ghi chÃº|
|---|---|---|---|
|**Prometheus**|âœ…|âŒ|LÆ°u sá»‘ lÆ°á»£ng, thá»i gian, táº§n suáº¥t|
|**Loki / Elasticsearch**|âŒ|âœ…|LÆ°u ná»™i dung log, request, error|
|**App server (logging)**|âœ… (ná»™i bá»™)|âœ…|Log ra stdout / file / syslog|

---

Báº¡n Ä‘ang muá»‘n lÆ°u nhá»¯ng **cÃ¢u request cá»¥ thá»ƒ nÃ o** (API nÃ o, chi tiáº¿t ra sao)? MÃ¬nh cÃ³ thá»ƒ gá»£i Ã½ thÃªm vá» cÃ¡ch cáº¥u hÃ¬nh log hoáº·c chá»n stack phÃ¹ há»£p.


---
1. [A Deep Dive Into the Four Types of Prometheus Metrics | Timescale](https://www.timescale.com/blog/four-types-prometheus-metrics-to-collect)